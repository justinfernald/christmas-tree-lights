"use strict";var T=Object.defineProperty;var E=(e,t,s)=>t in e?T(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var c=(e,t,s)=>E(e,typeof t!="symbol"?t+"":t,s);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});class h{constructor(t,s,n){this.x=t,this.y=s,this.z=n}static fromObject(t){return new h(t.x,t.y,t.z)}static fromTuple(t){return new h(t[0],t[1],t[2])}static zero(){return new h(0,0,0)}static forward(){return new h(0,0,1)}static backward(){return new h(0,0,-1)}static up(){return new h(0,1,0)}static down(){return new h(0,-1,0)}static left(){return new h(-1,0,0)}static right(){return new h(1,0,0)}static randomOnSphere(t){const s=Math.random(),n=Math.random(),i=2*Math.PI*s,r=Math.acos(2*n-1),x=t*Math.sin(r)*Math.cos(i),y=t*Math.sin(r)*Math.sin(i),z=t*Math.cos(r);return new h(x,y,z)}static randomInSphere(t){const s=Math.random(),n=Math.random(),i=2*Math.PI*s,r=Math.acos(2*n-1),x=t*Math.cbrt(Math.random()),y=x*Math.sin(r)*Math.cos(i),z=x*Math.sin(r)*Math.sin(i),a=x*Math.cos(r);return new h(y,z,a)}clone(){return new h(this.x,this.y,this.z)}add(t){return new h(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return new h(this.x-t.x,this.y-t.y,this.z-t.z)}mult(t){return new h(this.x*t.x,this.y*t.y,this.z*t.z)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){const s=this.y*t.z-this.z*t.y,n=this.z*t.x-this.x*t.z,i=this.x*t.y-this.y*t.x;return new h(s,n,i)}scale(t){return new h(this.x*t,this.y*t,this.z*t)}limitLength(t=1){return this.length<=t?this.clone():this.asLength(t)}asLength(t){return this.normalized.scale(t)}distanceTo(t){return Math.hypot(this.x-t.x,this.y-t.y,this.z-t.z)}get squaredMagnitude(){return this.x**2+this.y**2+this.z**2}get length(){return Math.hypot(this.x,this.y,this.z)}get normalized(){const t=this.length;return new h(this.x/t,this.y/t,this.z/t)}get asTuple(){return[this.x,this.y,this.z]}get asObject(){return{x:this.x,y:this.y,z:this.z}}negate(){return new h(-this.x,-this.y,-this.z)}rotateXYZ(t){const{x:s,y:n,z:i}=t,r=Math.cos(s),x=Math.sin(s),y=Math.cos(n),z=Math.sin(n),a=Math.cos(i),d=Math.sin(i),w=this.x*(y*a)+this.y*(r*d+x*z*a)+this.z*(x*d-r*z*a),f=this.x*(-y*d)+this.y*(r*a-x*z*d)+this.z*(x*a+r*z*d),Z=this.x*z+this.y*(-x*y)+this.z*(r*y);return new h(w,f,Z)}rotateXY(t){const s=Math.cos(t),n=Math.sin(t),i=this.x*s-this.y*n,r=this.x*n+this.y*s;return new h(i,r,this.z)}rotateYZ(t){const s=Math.cos(t),n=Math.sin(t),i=this.y*s-this.z*n,r=this.y*n+this.z*s;return new h(this.x,i,r)}rotateZX(t){const s=Math.cos(t),n=Math.sin(t),i=this.z*s-this.x*n,r=this.z*n+this.x*s;return new h(r,this.y,i)}rotateAroundAxis(t,s){const n=Math.cos(s),i=Math.sin(s),r=this.dot(t),x=t.y*this.z-t.z*this.y,y=t.z*this.x-t.x*this.z,z=t.x*this.y-t.y*this.x,a=this.x*n+x*i+r*(1-n)*t.x,d=this.y*n+y*i+r*(1-n)*t.y,w=this.z*n+z*i+r*(1-n)*t.z;return new h(a,d,w)}angleBetween(t){const s=this.dot(t),n=this.length*t.length;return Math.acos(s/n)}projectOnto(t){const s=this.dot(t),n=t.squaredMagnitude;if(n===0)throw new Error("Cannot project onto a zero-length vector.");const i=s/n;return t.scale(i)}midpoint(t){return new h((this.x+t.x)/2,(this.y+t.y)/2,(this.z+t.z)/2)}}const j=180/Math.PI,D=Math.PI/180,p=X(Array.from({length:256},(e,t)=>t));function S(e){return e*e*e*(e*(e*6-15)+10)}function b(e,t,s){const n=e&15,i=n<8?t:s,r=n<4?s:n===12||n===14?t:0;return(n&1?-i:i)+(n&2?-r:r)}function q(e,t){const s=Math.floor(e)&255,n=Math.floor(t)&255;e-=Math.floor(e),t-=Math.floor(t);const i=S(e),r=S(t),x=p[s]+n,y=p[s+1]+n;return L(L(b(p[x],e,t),b(p[y],e-1,t),i),L(b(p[x+1],e,t-1),b(p[y+1],e-1,t-1),i),r)}function l(e,t,s){return Math.min(Math.max(e,t),s)}function H(e,t,s){return e<t||e>s?null:(e-t)/(s-t)}function L(e,t,s){return e+(t-e)*s}function F(e,t,s){return e+C(t,e)*s}function C(e,t){return(t-e+180)%360-180}function G(e,t){return(e%t+t)%t}function M(e,t){return e+Math.random()*(t-e)}function R(e,t){return Math.floor(M(e,t))}function U(e){return e[R(0,e.length)]}function Y(){return Math.random()<.5}function $(){return Y()?1:-1}function k(e,t=[0,0]){const s=M(0,Math.PI*2),n=e*Math.sqrt(Math.random()),[i,r]=t;return[i+Math.cos(s)*n,r+Math.sin(s)*n]}function N(e,t=[0,0]){const s=M(0,Math.PI*2),[n,i]=t;return[n+Math.cos(s)*e,i+Math.sin(s)*e]}function J(e=0,t=360,s=100,n=50){const i=M(e,t);return o.fromHSL(i,s,n)}function X(e){const t=e.slice();for(let s=t.length-1;s>0;s--){const n=R(0,s+1);[t[s],t[n]]=[t[n],t[s]]}return t}function K(e){for(let t=e.length-1;t>0;t--){const s=R(0,t+1);[e[t],e[s]]=[e[s],e[t]]}return e}function I(e){return new Promise(t=>setTimeout(t,e))}function Q(e,t){let s=null;return(...i)=>{s!==null&&clearTimeout(s),s=setTimeout(()=>e(...i),t)}}const v=Object.freeze(Object.defineProperty({__proto__:null,DEG_TO_RAD:D,RAD_TO_DEG:j,angleDifference:C,clamp:l,debounce:Q,lerp:L,lerpAngle:F,mod:G,normalizeWithinRange:H,perlinNoise:q,random:M,randomBool:Y,randomChoice:U,randomColorByHue:J,randomInCircle:k,randomInt:R,randomOnCircle:N,randomSign:$,shuffle:X,shuffleInPlace:K,sleep:I},Symbol.toStringTag,{value:"Module"}));var O=(e=>(e[e.Normal=0]="Normal",e[e.Multiply=1]="Multiply",e[e.Screen=2]="Screen",e[e.Overlay=3]="Overlay",e[e.Darken=4]="Darken",e[e.Lighten=5]="Lighten",e[e.ColorDodge=6]="ColorDodge",e[e.ColorBurn=7]="ColorBurn",e[e.HardLight=8]="HardLight",e[e.SoftLight=9]="SoftLight",e[e.Difference=10]="Difference",e[e.Exclusion=11]="Exclusion",e[e.Gamma=12]="Gamma",e))(O||{});const g=class g{constructor(t,s,n){this.red=t,this.green=s,this.blue=n}blendChannel(t,s,n){return l(Math.round(n(t/255,s/255)*255),0,255)}blend(t,s=5){const n=g.blendFuncs[s];return new g(this.blendChannel(this.red,t.red,n),this.blendChannel(this.green,t.green,n),this.blendChannel(this.blue,t.blue,n))}toHSL(){const t=this.red/255,s=this.green/255,n=this.blue/255,i=Math.max(t,s,n),r=Math.min(t,s,n);let x=(i+r)/2,y=x;const z=x;if(i===r)x=y=0;else{const a=i-r;switch(y=z>.5?a/(2-i-r):a/(i+r),i){case t:x=(s-n)/a+(s<n?6:0);break;case s:x=(n-t)/a+2;break;case n:x=(t-s)/a+4;break}x/=6}return[Math.round(x*360),Math.round(y*100),Math.round(z*100)]}complementary(){const[t,s,n]=this.toHSL();return g.fromHSL((t+180)%360,s,n)}intensity(t){return new g(l(Math.round(this.red*t),0,255),l(Math.round(this.green*t),0,255),l(Math.round(this.blue*t),0,255))}toString(){return`rgb(${this.red}, ${this.green}, ${this.blue})`}toInt(){return(this.red&255)<<16|(this.green&255)<<8|this.blue&255}static fromInt(t){return t=l(t,0,16777215),new g(t>>16&255,t>>8&255,t&255)}static fromHex(t){const s=t.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);if(!s)throw new Error(`Invalid hex color: ${t}`);return new g(parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16))}static fromRGB(t,s,n){return t=l(t,0,255),s=l(s,0,255),n=l(n,0,255),new g(t,s,n)}static fromHSL(t,s,n){t=l(t,0,360),s=l(s,0,100),n=l(n,0,100),t/=360,s/=100,n/=100;let i,r,x;if(s===0)i=r=x=n;else{const y=(d,w,f)=>(f<0&&(f+=1),f>1&&(f-=1),f<.16666666666666666?d+(w-d)*6*f:f<.5?w:f<.6666666666666666?d+(w-d)*(.6666666666666666-f)*6:d),z=n<.5?n*(1+s):n+s-n*s,a=2*n-z;i=y(a,z,t+1/3),r=y(a,z,t),x=y(a,z,t-1/3)}return new g(Math.round(i*255),Math.round(r*255),Math.round(x*255))}};c(g,"blendFuncs",{0:(t,s)=>s,1:(t,s)=>t*s,2:(t,s)=>t+s-t*s,3:(t,s)=>t<.5?2*t*s:1-2*(1-t)*(1-s),4:(t,s)=>Math.min(t,s),5:(t,s)=>Math.max(t,s),6:(t,s)=>s===1?1:Math.min(1,t/(1-s)),7:(t,s)=>s===0?0:1-Math.min(1,(1-t)/s),8:(t,s)=>s<.5?2*t*s:1-2*(1-t)*(1-s),9:(t,s)=>s<.5?2*t*s+t*t*(1-2*s):Math.sqrt(t)*(2*s-1)+2*t*(1-s),10:(t,s)=>Math.abs(t-s),11:(t,s)=>t+s-2*t*s,12:(t,s)=>((t**2.2+s**2.2)/2)**(1/2.2)});let o=g;const B={red:new o(255,0,0),green:new o(0,255,0),blue:new o(0,0,255),orange:new o(255,165,0),yellow:new o(255,255,0),purple:new o(128,0,128),pink:new o(255,20,147),white:new o(255,255,255),black:new o(0,0,0),gray:new o(128,128,128),brown:new o(165,42,42),cyan:new o(0,255,255),darkGreen:new o(0,128,0),darkBlue:new o(0,0,128),darkOrange:new o(255,140,0),darkYellow:new o(128,128,0),darkPurple:new o(75,0,130),darkPink:new o(255,105,180),darkGray:new o(64,64,64),darkBrown:new o(139,69,19),darkCyan:new o(0,128,128)};class A{constructor(t,s){c(this,"_location");c(this,"color");c(this,"update");this._location=t,this.color=s}get location(){return new h(this._location.x,this._location.y,1-this._location.z)}get locationScaled(){return this.location.mult(new h(1,1,1.74))}get locationOriginCenter(){return this.location.sub(new h(.5,.5,.5))}get locationOriginCenterScaled(){return this.locationOriginCenter.mult(new h(1,1,1.74))}get locationOriginCenterBottom(){return this.location.sub(new h(.5,.5,0))}get locationOriginCenterBottomScaled(){return this.locationOriginCenterBottom.mult(new h(1,1,1.74))}toDto(){return{location:this._location.asTuple,color:this.color.toInt()}}static fromDto(t){return new A(h.fromTuple(t.location),o.fromInt(t.color))}}class u{constructor(){}isPointInside(t,s,n){return!1}}class W extends u{constructor(t,s,n){super(),this.radius=t,this.height=s,this.center=n}isPointInside(t,s,n){const i=Math.sqrt((t-this.center.x)**2+(s-this.center.y)**2),x=this.radius/this.height*(n-this.center.z)+this.radius;return i<=x&&n>=this.center.z-this.height/2&&n<=this.center.z+this.height/2}}class _ extends u{constructor(t,s,n,i){super(),this.nearRadius=t,this.farRadius=s,this.height=n,this.center=i}isPointInside(t,s,n){const i=Math.sqrt((t-this.center.x)**2+(s-this.center.y)**2),x=(this.farRadius-this.nearRadius)/this.height*(n-this.center.z)+this.nearRadius;return i<=x&&n>=this.center.z-this.height/2&&n<=this.center.z+this.height/2}}class V extends u{constructor(t,s){super(),this.sideLength=t,this.center=s}isPointInside(t,s,n){const i=this.sideLength/2;return Math.abs(t-this.center.x)<=i&&Math.abs(s-this.center.y)<=i&&Math.abs(n-this.center.z)<=i}}class t0 extends u{constructor(t,s,n,i){super(),this.lengthX=t,this.lengthY=s,this.lengthZ=n,this.center=i}isPointInside(t,s,n){const i=this.lengthX/2,r=this.lengthY/2,x=this.lengthZ/2;return t>=this.center.x-i&&t<=this.center.x+i&&s>=this.center.y-r&&s<=this.center.y+r&&n>=this.center.z-x&&n<=this.center.z+x}}class s0 extends u{constructor(t,s,n){super(),this.radius=t,this.height=s,this.center=n}isPointInside(t,s,n){return Math.sqrt((t-this.center.x)**2+(s-this.center.y)**2)<=this.radius&&n>=this.center.z-this.height/2&&n<=this.center.z+this.height/2}}class n0 extends u{constructor(t,s,n,i){super(),this.majorRadius=t,this.minorRadius=s,this.height=n,this.center=i}isPointInside(t,s,n){return Math.sqrt((t-this.center.x)**2+(s-this.center.y)**2)<=this.majorRadius&&n>=this.center.z-this.height/2&&n<=this.center.z+this.height/2&&Math.sqrt((t-this.center.x)**2/this.majorRadius**2+(s-this.center.y)**2/this.minorRadius**2)<=1}}class e0 extends u{constructor(t,s,n,i){super(),this.semiAxisX=t,this.semiAxisY=s,this.semiAxisZ=n,this.center=i}isPointInside(t,s,n){const i=(t-this.center.x)/this.semiAxisX,r=(s-this.center.y)/this.semiAxisY,x=(n-this.center.z)/this.semiAxisZ;return i**2+r**2+x**2<=1}}class i0 extends u{constructor(t,s,n,i,r,x,y){super(),this.near=t,this.far=s,this.left=n,this.right=i,this.top=r,this.bottom=x,this.center=y}isPointInside(t,s,n){const i=this.near/2,r=this.far/2;return t>=this.center.x-i&&t<=this.center.x+i&&s>=this.center.y-i&&s<=this.center.y+i&&n>=this.center.z-i&&n<=this.center.z+r}}class r0 extends u{constructor(t,s,n){super(),this.sideLength=t,this.height=s,this.center=n}isPointInside(t,s,n){const i=this.sideLength/2,r=this.center.z+this.height/2,x=this.center.z-this.height/2;this.center.x+i,this.center.y+i;const y=Math.abs(t-this.center.x),z=Math.abs(s-this.center.y);return n>=x&&n<=r&&y<=i&&z<=i&&(y+z)*Math.sqrt(3)/2<=i}}class x0 extends u{constructor(t,s){super(),this.edgeLength=t,this.center=s}isPointInside(t,s,n){const i=this.edgeLength/2,r=this.center.z+i,x=this.center.z-i;this.center.x+i,this.center.y+i;const y=Math.abs(t-this.center.x),z=Math.abs(s-this.center.y);return n>=x&&n<=r&&y+z+Math.abs(n-this.center.z)<=i}}class h0 extends u{constructor(t,s,n){super(),this.baseLength=t,this.height=s,this.center=n}isPointInside(t,s,n){const i=this.baseLength/2,r=this.center.z+this.height/2,x=this.center.z-this.height/2,y=this.center.x+i,z=this.center.y+i;return!(n>r||n<x||t>y||t<this.center.x-i||s>z||s<this.center.y-i)}}class y0 extends u{constructor(t,s,n,i){super(),this.lengthX=t,this.lengthY=s,this.lengthZ=n,this.center=i}isPointInside(t,s,n){const i=this.lengthX/2,r=this.lengthY/2,x=this.lengthZ/2;return t>=this.center.x-i&&t<=this.center.x+i&&s>=this.center.y-r&&s<=this.center.y+r&&n>=this.center.z-x&&n<=this.center.z+x}}class z0 extends u{constructor(t,s){super(),this.radius=t,this.center=s}isPointInside(t,s,n){return Math.sqrt((t-this.center.x)**2+(s-this.center.y)**2+(n-this.center.z)**2)<=this.radius}}class o0 extends u{constructor(t,s,n){super(),this.majorRadius=t,this.minorRadius=s,this.center=n}isPointInside(t,s,n){const i=Math.sqrt((t-this.center.x)**2+(s-this.center.y)**2);return i>=this.majorRadius-this.minorRadius&&i<=this.majorRadius+this.minorRadius&&Math.abs(n-this.center.z)<=this.minorRadius}}class a0 extends u{constructor(t,s,n){super(),this.baseLength=t,this.height=s,this.center=n}isPointInside(t,s,n){const i=this.baseLength/2,r=this.center.z+this.height/2,x=this.center.z-this.height/2,y=this.center.x+i,z=this.center.y+i;return n>=x&&n<=r&&t>=this.center.x-i&&t<=y&&s>=this.center.y-i&&s<=z}}const c0=Object.freeze(Object.defineProperty({__proto__:null,Cone:W,ConeFrustum:_,Cube:V,Cuboid:t0,Cylinder:s0,CylinderWithEllipticalBase:n0,Ellipsoid:e0,Frustum:i0,HexagonalPrism:r0,Octahedron:x0,Pyramid:h0,RectangularPrism:y0,Shape:u,Sphere:z0,Torus:o0,TriangularPyramid:a0},Symbol.toStringTag,{value:"Module"})),u0=[{x:.5,y:.056,z:1},{x:.526,y:.042,z:.969},{x:.526,y:.042,z:.922},{x:.487,y:.097,z:.938},{x:.447,y:.097,z:.961},{x:.421,y:.222,z:.961},{x:.526,y:.153,z:.922},{x:.421,y:.139,z:.938},{x:.395,y:.181,z:.961},{x:.368,y:.222,z:.969},{x:.237,y:.25,z:.977},{x:.224,y:.319,z:1},{x:.184,y:.333,z:.977},{x:.158,y:.361,z:.93},{x:.158,y:.417,z:.969},{x:.132,y:.514,z:.953},{x:.197,y:.556,z:.984},{x:.145,y:.597,z:.961},{x:.132,y:.667,z:.946},{x:.145,y:.722,z:.938},{x:.184,y:.778,z:.938},{x:.211,y:.806,z:.961},{x:.316,y:.778,z:.969},{x:.368,y:.806,z:.961},{x:.434,y:.778,z:.922},{x:.487,y:.819,z:.953},{x:.566,y:.792,z:.953},{x:.658,y:.75,z:.969},{x:.684,y:.722,z:.969},{x:.711,y:.708,z:1},{x:.803,y:.681,z:1},{x:.855,y:.625,z:1},{x:.895,y:.583,z:.969},{x:1,y:.528,z:.938},{x:.987,y:.472,z:.984},{x:.895,y:.417,z:.984},{x:.868,y:.375,z:.969},{x:.921,y:.319,z:.922},{x:.895,y:.278,z:.899},{x:.803,y:.194,z:.876},{x:.789,y:.208,z:.899},{x:.684,y:.181,z:.891},{x:.671,y:.181,z:.876},{x:.605,y:.181,z:.868},{x:.566,y:.139,z:.891},{x:.5,y:.153,z:.907},{x:.434,y:.139,z:.907},{x:.342,y:.167,z:.915},{x:.303,y:.139,z:.899},{x:.237,y:.153,z:.868},{x:.145,y:.333,z:.822},{x:.145,y:.444,z:.814},{x:.105,y:.5,z:.798},{x:.118,y:.542,z:.822},{x:.197,y:.597,z:.798},{x:.224,y:.667,z:.822},{x:.237,y:.736,z:.837},{x:.276,y:.806,z:.837},{x:.303,y:.833,z:.86},{x:.368,y:.889,z:.86},{x:.421,y:.889,z:.86},{x:.513,y:.833,z:.853},{x:.579,y:.847,z:.845},{x:.658,y:.889,z:.837},{x:.697,y:.861,z:.822},{x:.816,y:.819,z:.822},{x:.842,y:.764,z:.845},{x:.816,y:.694,z:.876},{x:.789,y:.611,z:.868},{x:.868,y:.528,z:.884},{x:.921,y:.514,z:.845},{x:.947,y:.417,z:.86},{x:.882,y:.347,z:.868},{x:.816,y:.333,z:.86},{x:.789,y:.264,z:.845},{x:.724,y:.306,z:.829},{x:.684,y:.208,z:.806},{x:.579,y:.264,z:.806},{x:.513,y:.236,z:.798},{x:.447,y:.236,z:.767},{x:.382,y:.264,z:.775},{x:.342,y:.278,z:.767},{x:.303,y:.333,z:.775},{x:.289,y:.417,z:.775},{x:.289,y:.486,z:.775},{x:.25,y:.569,z:.767},{x:.263,y:.639,z:.767},{x:.263,y:.75,z:.767},{x:.289,y:.792,z:.767},{x:.368,y:.875,z:.744},{x:.395,y:.875,z:.775},{x:.474,y:.875,z:.791},{x:.539,y:.875,z:.814},{x:.605,y:.806,z:.791},{x:.697,y:.764,z:.744},{x:.763,y:.806,z:.744},{x:.724,y:.736,z:.752},{x:.763,y:.639,z:.76},{x:.737,y:.569,z:.736},{x:.487,y:.528,z:.775},{x:.605,y:.431,z:.798},{x:.618,y:.361,z:.829},{x:.579,y:.389,z:.829},{x:.487,y:.347,z:.845},{x:.447,y:.444,z:.845},{x:.408,y:.431,z:.876},{x:.421,y:.472,z:.876},{x:.368,y:.556,z:.891},{x:.382,y:.583,z:.876},{x:.461,y:.611,z:.853},{x:.487,y:.611,z:.853},{x:.526,y:.667,z:.837},{x:.618,y:.611,z:.86},{x:.632,y:.611,z:.868},{x:.671,y:.514,z:.876},{x:.684,y:.458,z:.899},{x:.763,y:.431,z:.899},{x:.803,y:.333,z:.907},{x:.789,y:.25,z:.891},{x:.842,y:.167,z:.899},{x:.789,y:.222,z:.938},{x:.711,y:.111,z:.93},{x:.408,y:.194,z:.938},{x:.632,y:.167,z:.93},{x:.605,y:.083,z:.946},{x:.526,y:.014,z:.961},{x:.434,y:0,z:.938},{x:.368,y:.042,z:.953},{x:.368,y:.139,z:.946},{x:.276,y:.167,z:.946},{x:.25,y:.222,z:.946},{x:.211,y:.25,z:.876},{x:.145,y:.222,z:.915},{x:.092,y:.194,z:.907},{x:.026,y:.278,z:.93},{x:.105,y:.347,z:.953},{x:.013,y:.389,z:.961},{x:.092,y:.5,z:.977},{x:.026,y:.583,z:.984},{x:0,y:.625,z:.953},{x:.026,y:.694,z:.953},{x:.053,y:.75,z:.961},{x:.105,y:.75,z:.977},{x:.211,y:.764,z:.977},{x:.237,y:.792,z:.969},{x:.355,y:.764,z:.961},{x:.118,y:.792,z:.946},{x:.474,y:.819,z:.907},{x:.447,y:.861,z:.876},{x:.5,y:.806,z:.837},{x:.579,y:.917,z:.798},{x:.658,y:.917,z:.775},{x:.684,y:.958,z:.806},{x:.724,y:.972,z:.86},{x:.658,y:.986,z:.884},{x:.605,y:.972,z:.884},{x:.513,y:1,z:.891},{x:.474,y:.917,z:.884},{x:.368,y:.931,z:.876},{x:.329,y:.875,z:.876},{x:.263,y:.931,z:.829},{x:.211,y:.903,z:.86},{x:.158,y:.833,z:.868},{x:.105,y:.75,z:.884},{x:.132,y:.653,z:.837},{x:.105,y:.625,z:.853},{x:.039,y:.569,z:.806},{x:.053,y:.528,z:.822},{x:.105,y:.458,z:.806},{x:.132,y:.375,z:.767},{x:.211,y:.333,z:.798},{x:.263,y:.319,z:.775},{x:.289,y:.25,z:.775},{x:.263,y:.403,z:.767},{x:.355,y:.167,z:.798},{x:.408,y:.125,z:.814},{x:.487,y:.125,z:.806},{x:.553,y:.069,z:.791},{x:.632,y:.083,z:.775},{x:.671,y:.069,z:.736},{x:.632,y:.194,z:.752},{x:.737,y:.208,z:.752},{x:.763,y:.25,z:.76},{x:.776,y:.319,z:.791},{x:.763,y:.361,z:.806},{x:.789,y:.444,z:.806},{x:.776,y:.5,z:.806},{x:.711,y:.583,z:.775},{x:.711,y:.611,z:.775},{x:.658,y:.708,z:.752},{x:.592,y:.75,z:.736},{x:.618,y:.708,z:.798},{x:.592,y:.722,z:.721},{x:.487,y:.736,z:.744},{x:.474,y:.708,z:.783},{x:.447,y:.639,z:.783},{x:.395,y:.625,z:.767},{x:.421,y:.583,z:.744},{x:.368,y:.611,z:.736},{x:.316,y:.569,z:.69},{x:.25,y:.653,z:.69},{x:.184,y:.667,z:.682},{x:.237,y:.681,z:.721},{x:.158,y:.722,z:.767},{x:.224,y:.764,z:.783},{x:.289,y:.764,z:.744},{x:.342,y:.778,z:.76},{x:.408,y:.736,z:.713},{x:.434,y:.806,z:.729},{x:.5,y:.875,z:.713},{x:.553,y:.875,z:.744},{x:.632,y:.847,z:.744},{x:.711,y:.806,z:.721},{x:.684,y:.806,z:.682},{x:.789,y:.792,z:.69},{x:.711,y:.694,z:.667},{x:.789,y:.708,z:.721},{x:.763,y:.639,z:.713},{x:.868,y:.583,z:.721},{x:.855,y:.458,z:.698},{x:.855,y:.472,z:.698},{x:.842,y:.403,z:.674},{x:.776,y:.333,z:.682},{x:.737,y:.25,z:.682},{x:.434,y:.264,z:.705},{x:.658,y:.222,z:.674},{x:.553,y:.222,z:.69},{x:.526,y:.181,z:.659},{x:.434,y:.111,z:.667},{x:.368,y:.167,z:.674},{x:.316,y:.222,z:.651},{x:.316,y:.278,z:.674},{x:.263,y:.292,z:.674},{x:.25,y:.361,z:.667},{x:.211,y:.458,z:.612},{x:.237,y:.514,z:.667},{x:.237,y:.542,z:.667},{x:.263,y:.653,z:.667},{x:.224,y:.694,z:.659},{x:.289,y:.764,z:.628},{x:.276,y:.847,z:.643},{x:.355,y:.819,z:.659},{x:.408,y:.903,z:.667},{x:.474,y:.889,z:.69},{x:.553,y:.861,z:.69},{x:.605,y:.903,z:.682},{x:.671,y:.847,z:.674},{x:.737,y:.889,z:.643},{x:.763,y:.806,z:.659},{x:.763,y:.75,z:.674},{x:.842,y:.611,z:.628},{x:.816,y:.5,z:.589},{x:.895,y:.5,z:.581},{x:.592,y:.444,z:.636},{x:.816,y:.417,z:.659},{x:.737,y:.347,z:.667},{x:.658,y:.278,z:.628},{x:.658,y:.25,z:.605},{x:.592,y:.222,z:.612},{x:.553,y:.278,z:.659},{x:.539,y:.278,z:.659},{x:.461,y:.278,z:.651},{x:.434,y:.292,z:.566},{x:.382,y:.292,z:.651},{x:.342,y:.333,z:.667},{x:.303,y:.431,z:.651},{x:.224,y:.389,z:.62},{x:.289,y:.431,z:.62},{x:.211,y:.528,z:.643},{x:.316,y:.611,z:.674},{x:.342,y:.667,z:.651},{x:.355,y:.653,z:.643},{x:.395,y:.667,z:.589},{x:.395,y:.653,z:.574},{x:.474,y:.639,z:.581},{x:.461,y:.583,z:.597},{x:.566,y:.569,z:.581},{x:.513,y:.458,z:.597},{x:.447,y:.486,z:.589},{x:.421,y:.417,z:.574},{x:.368,y:.375,z:.504},{x:.316,y:.306,z:.504},{x:.303,y:.403,z:.519},{x:.289,y:.486,z:.488},{x:.316,y:.5,z:.543},{x:.421,y:.611,z:.55},{x:.447,y:.667,z:.55},{x:.5,y:.625,z:.55},{x:.5,y:.556,z:.543},{x:.566,y:.556,z:.527},{x:.513,y:.5,z:.519},{x:.553,y:.389,z:.488},{x:.487,y:.306,z:.473},{x:.447,y:.236,z:.457},{x:.434,y:.292,z:.496},{x:.368,y:.306,z:.504},{x:.342,y:.361,z:.504},{x:.289,y:.403,z:.473},{x:.303,y:.458,z:.519},{x:.303,y:.542,z:.504},{x:.395,y:.694,z:.481},{x:.368,y:.75,z:.488},{x:.447,y:.75,z:.496},{x:.474,y:.833,z:.488},{x:.553,y:.792,z:.488},{x:.605,y:.833,z:.481},{x:.658,y:.764,z:.442},{x:.737,y:.708,z:.465},{x:.737,y:.639,z:.481},{x:.737,y:.597,z:.488},{x:.711,y:.542,z:.504},{x:.789,y:.472,z:.512},{x:.789,y:.375,z:.519},{x:.737,y:.306,z:.519},{x:.658,y:.306,z:.504},{x:.605,y:.347,z:.481},{x:.579,y:.361,z:.473},{x:.487,y:.306,z:.45},{x:.447,y:.333,z:.457},{x:.368,y:.375,z:.481},{x:.316,y:.403,z:.465},{x:.526,y:.361,z:.473},{x:.237,y:.444,z:.473},{x:.263,y:.514,z:.473},{x:.316,y:.569,z:.473},{x:.368,y:.569,z:.45},{x:.447,y:.694,z:.457},{x:.474,y:.708,z:.45},{x:.553,y:.708,z:.442},{x:.684,y:.694,z:.442},{x:.684,y:.708,z:.457},{x:.763,y:.611,z:.45},{x:.684,y:.597,z:.481},{x:.737,y:.528,z:.488},{x:.711,y:.5,z:.442},{x:.697,y:.417,z:.411},{x:.632,y:.431,z:.419},{x:.566,y:.389,z:.488},{x:.553,y:.389,z:.496},{x:.579,y:.417,z:.465},{x:.618,y:.528,z:.457},{x:.579,y:.611,z:.496},{x:.605,y:.556,z:.55},{x:.632,y:.639,z:.589},{x:.632,y:.708,z:.589},{x:.711,y:.792,z:.566},{x:.711,y:.75,z:.574},{x:.737,y:.861,z:.597},{x:.737,y:.833,z:.628},{x:.684,y:.847,z:.628},{x:.447,y:.833,z:.628},{x:.368,y:.806,z:.612},{x:.342,y:.806,z:.612},{x:.263,y:.708,z:.628},{x:.289,y:.653,z:.643},{x:.211,y:.611,z:.651},{x:.184,y:.556,z:.636},{x:.132,y:.472,z:.628},{x:.158,y:.361,z:.628},{x:.145,y:.361,z:.659},{x:.171,y:.278,z:.667},{x:.237,y:.25,z:.659},{x:.211,y:.153,z:.659},{x:.276,y:.208,z:.628},{x:.368,y:.111,z:.62},{x:.382,y:.125,z:.581},{x:.408,y:.111,z:.612},{x:.5,y:.167,z:.597},{x:.553,y:.125,z:.597},{x:.645,y:.139,z:.581},{x:.697,y:.194,z:.566},{x:.711,y:.292,z:.581},{x:.776,y:.333,z:.558},{x:.737,y:.375,z:.519},{x:.737,y:.417,z:.543},{x:.829,y:.486,z:.543},{x:.75,y:.528,z:.55},{x:.789,y:.653,z:.566},{x:.763,y:.667,z:.566},{x:.737,y:.764,z:.566},{x:.684,y:.806,z:.566},{x:.632,y:.819,z:.574},{x:.605,y:.889,z:.543},{x:.526,y:.792,z:.55},{x:.474,y:.792,z:.566},{x:.368,y:.75,z:.566},{x:.316,y:.75,z:.558},{x:.25,y:.722,z:.535},{x:.263,y:.625,z:.558},{x:.263,y:.569,z:.566},{x:.197,y:.5,z:.566},{x:.211,y:.486,z:.55},{x:.237,y:.375,z:.535},{x:.25,y:.306,z:.535},{x:.303,y:.278,z:.527},{x:.316,y:.25,z:.457},{x:.368,y:.208,z:.488},{x:.395,y:.167,z:.434},{x:.474,y:.181,z:.457},{x:.526,y:.222,z:.434},{x:.645,y:.333,z:.403},{x:.697,y:.347,z:.357},{x:.684,y:.444,z:.364},{x:.816,y:.528,z:.349},{x:.842,y:.556,z:.349},{x:.763,y:.583,z:.372},{x:.711,y:.694,z:.38},{x:.592,y:.722,z:.38},{x:.592,y:.778,z:.38},{x:.526,y:.792,z:.38},{x:.461,y:.736,z:.364},{x:.368,y:.694,z:.357},{x:.355,y:.611,z:.372},{x:.237,y:.597,z:.341},{x:.276,y:.5,z:.349},{x:.158,y:.208,z:.333},{x:.105,y:.431,z:.318},{x:.211,y:.333,z:.302},{x:.355,y:.069,z:.333},{x:.342,y:.264,z:.318},{x:.395,y:.236,z:.333},{x:.5,y:.264,z:.302},{x:.566,y:.25,z:.349},{x:.605,y:.306,z:.302},{x:.618,y:.333,z:.318},{x:.684,y:.389,z:.318},{x:.737,y:.472,z:.31},{x:.671,y:.486,z:.302},{x:.737,y:.542,z:.287},{x:.592,y:.625,z:.302},{x:.579,y:.667,z:.302},{x:.605,y:.75,z:.271},{x:.5,y:.667,z:.287},{x:.434,y:.667,z:.295},{x:.316,y:.667,z:.271},{x:.289,y:.611,z:.287},{x:.237,y:.569,z:.264},{x:.263,y:.514,z:.279},{x:.237,y:.403,z:.264},{x:.408,y:.361,z:.264},{x:.382,y:.319,z:.248},{x:.5,y:.264,z:.24},{x:.553,y:.278,z:.225},{x:.592,y:.361,z:.233},{x:.697,y:.375,z:.217},{x:.724,y:.472,z:.217},{x:.737,y:.583,z:.217},{x:.697,y:.653,z:.209},{x:.697,y:.653,z:.209},{x:.632,y:.736,z:.194},{x:.395,y:.736,z:.178},{x:.408,y:.611,z:.186},{x:.289,y:.583,z:.194},{x:.303,y:.5,z:.194},{x:.303,y:.5,z:.194},{x:.263,y:.361,z:.194},{x:.368,y:.333,z:.186},{x:.434,y:.333,z:.202},{x:.539,y:.333,z:.194},{x:.5,y:.278,z:.178},{x:.605,y:.194,z:.163},{x:.645,y:.194,z:.155},{x:.684,y:.389,z:.155},{x:.684,y:.458,z:.163},{x:.684,y:.556,z:.155},{x:.671,y:.639,z:.147},{x:.579,y:.694,z:.147},{x:.539,y:.75,z:.132},{x:.487,y:.75,z:.14},{x:.461,y:.611,z:.14},{x:.395,y:.639,z:.124},{x:.342,y:.5,z:.101},{x:.329,y:.486,z:.085},{x:.316,y:.444,z:.116},{x:.276,y:.417,z:.132},{x:.395,y:.333,z:.163},{x:.434,y:.306,z:.163},{x:.5,y:.25,z:.124},{x:.579,y:.25,z:.116},{x:.618,y:.361,z:.116},{x:.658,y:.417,z:.07},{x:.618,y:.486,z:.054},{x:.632,y:.528,z:.093},{x:.645,y:.639,z:.078},{x:.5,y:.667,z:.07},{x:.526,y:.778,z:.054},{x:.447,y:.722,z:.039},{x:.368,y:.556,z:.039},{x:.316,y:.556,z:.054},{x:.263,y:.778,z:.054},{x:.276,y:.444,z:.054},{x:.395,y:.333,z:.039},{x:.461,y:.292,z:.023},{x:.513,y:.306,z:.016},{x:.618,y:.472,z:.008},{x:.645,y:.5,z:.039},{x:.592,y:.556,z:.039},{x:.579,y:.611,z:.016},{x:.553,y:.625,z:.008},{x:.447,y:.611,z:0}];class d0{constructor(){c(this,"audioRunner",null);c(this,"setup");c(this,"update");c(this,"lights",u0.map(t=>new A(h.fromObject(t),new o(0,0,0))));c(this,"time",null);c(this,"iteration",0);c(this,"running",!1)}async run(){var t,s,n;for((!this.running||this.time===null)&&(this.time=0,this.running=!0,(t=this.setup)==null||t.call(this));this.running;){this.time===null&&(this.time=0,(s=this.setup)==null||s.call(this));const i=1e3/this.fps;(n=this.update)==null||n.call(this,this.time,i,this.iteration),this.lightUpdate(this.time,i,this.iteration),this.draw(),this.iteration++,this.time+=i,await I(i)}}reset(){var t;this.iteration=0,this.time=null;for(const s of this.lights)s.color=new o(0,0,0);this.draw(),(t=this.audioRunner)==null||t.audioReset()}pause(){var t;this.running=!1,(t=this.audioRunner)==null||t.audioPause()}play(){var t;this.running=!0,this.run(),(t=this.audioRunner)==null||t.audioPlay()}async step(){var s,n;this.running=!0,this.run(),this.running=!1,(s=this.audioRunner)==null||s.audioPlay();const t=1e3/this.fps;await I(t),(n=this.audioRunner)==null||n.audioPause()}lightUpdate(t,s,n){var i;for(const r of this.lights){const x=(i=r.update)==null?void 0:i.call(r,t,s,n);x&&(r.color=x)}}}class l0 extends d0{constructor(){super(...arguments);c(this,"_fps",30)}set fps(s){this._fps=s,postMessage({type:"fps",data:{fps:s}})}get fps(){return this._fps}draw(){postMessage({type:"update",data:{lights:this.lights.map(s=>s.toDto())}})}}var m=(e=>(e.Update="update",e.Play="play",e.Pause="pause",e.Reset="reset",e.Step="step",e.Ready="ready",e.Confirmation="confirmation",e.Code="code",e.Fps="fps",e.AudioTime="audioTime",e.AudioEnded="audioEnded",e.AudioPause="audioPause",e.AudioPlay="audioPlay",e.AudioReset="audioReset",e.AudioUrl="audioUrl",e.AudioLoaded="audioLoaded",e))(m||{});class f0{constructor(t,s=!0){c(this,"loader",null);c(this,"audioTime");c(this,"audioEnded");this.loader=this.audioLoader(t,s)}}class g0 extends f0{constructor(s,n){super(s,n);c(this,"audioMessageListener",s=>{var n,i;s.data.type===m.AudioTime?(n=this.audioTime)==null||n.call(this,s.data.data.time):s.data.type===m.AudioEnded&&((i=this.audioEnded)==null||i.call(this))});addEventListener("message",this.audioMessageListener)}audioLoader(s,n=!0){return P(m.AudioUrl,{url:s,loop:n}),new Promise(i=>{const r=x=>{x.data.type===m.AudioLoaded&&(i(),removeEventListener("message",r))};addEventListener("message",r)})}audioPause(){P(m.AudioPause,{})}audioPlay(){P(m.AudioPlay,{})}audioReset(){P(m.AudioReset,{})}}function P(e,t){const s=Math.random().toString(36).slice(2);postMessage(t?{type:e,data:{...t,messageId:s}}:{type:e,data:{messageId:s}})}const m0=new l0;exports.BlendMode=O;exports.Color=o;exports.Light=A;exports.LocalAudioRunner=g0;exports.Shapes=c0;exports.Utils=v;exports.Vector3=h;exports.colors=B;exports.runner=m0;
